---
title: "Analiza umrljivosti otrok do 5. leta starosti"
author: "Katarina Kromar"
output:
  html_document: default
  pdf_document:
    includes:
      in_header: lib/styles.sty
    latex_engine: xelatex
---    

```{r setup, echo=FALSE, results='hide', message=FALSE,warning=FALSE}
# Če želimo nastaviti pisave v PDF-ju, odkomentiramo
# in sledimo navodilom v programu.
#source("fontconfig.r", encoding = "UTF-8")

# Uvoz vseh potrebnih knjižnic
source("lib/libraries.r", encoding = "UTF-8")
require(ggplot2)
require(dplyr)
require(reshape2)
```

# Izbira teme

Analizirala bom podatke o umrljivosti otrok po svetu do 5. leta starosti ter umrljivost dojenčkov. Najprej bom analizirala delež cepljenih v 1. letu starosti glede na spol, nato pa še delež nerazvitih ter podhranjenih otrok do 5. leta starosti (podatki od leta 2010 do 2014).

Skozi analizo želim izvedeti kolikšen delež tistih, ki umrejo, je podhranjenih ali nerazvitih, ter ali ima cepljenje vpliv na umrljivost otrok.

Podatke sem pridobila na spletu:

* http://apps.who.int/gho/data/node.main.ChildMort-1?lang=en (umrljivost, podatki so v obliki CSV)

* http://apps.who.int/gho/data/node.main.HE-1588?lang=en (cepljenost, podatki so v obliki CSV)

* http://apps.who.int/gho/data/node.main.1098?lang=en (podhranjenost, podatki v obliki JSON)

* http://apps.who.int/gho/data/view.main.90200 (nerazvitost, podatki v obliki JSON)


***

# Obdelava, uvoz in čiščenje podatkov

```{r uvoz, echo=FALSE, include=FALSE}
source("uvoz/uvozpodatkov.r", encoding = "UTF-8")
```

Uvozila sem podatke o umrljivosti in cepljenosti v obliki CSV s spletne strani World Health Organization ter podatke o podhranjenosti in nerazvitosti v obliki JSON
z iste spletne strani. Poglejmo si začetka obeh uvoženih razpredelnic v obliki CSV.

```{r razpredelnice, echo=FALSE}
kable(head(analiza %>% select(Drzava, Leto, Smrtnost.do.5.leta.starosti, Smrtnost.dojenckov)))
kable(head(tidy_analiza %>% select(Drzava, Leto, Spol, Cepljenost)))
```


Umrljivost:

* Drzava - podatki za različne države sveta, tip: character

* Leto - podatki so do leta 2015, podani so številsko

* Smrtnost.do.5.leta.starosti - prikazuje število umrlih do 5.leta starosti, podatki so v tisočih, tako da je pravo število umrlih pomnoženo s tisoč, podani so številsko

* Smrtnost.dojenckov - smrtnost dojenčkov, podatki so v tisočih, tako da je pravo število umrlih pomnoženo s tisoč, podani so številsko


Stolpce sem preimenovala v slovenščino, ter jih preuredila. Pri urejanju podatkov sem imela nekaj težav, saj sem imela zraven podatkov v oklepajih še nekatere, ki jih nisem potrebovala, zato sem se morala znebiti tistih oklepajev, ter spremeniti v številske vrednosti. Izbrisala sem tudi vrstice, ki so vsebovale NA. Število vrstic je 3608.

Cepljenost \ref{fig:razpredelnice}:

* Drzava - podatki za različne države sveta, tip: character

* Leto - podatki so od leta 2010 do 2014, podani so številsko

* Cepljenost.Z - prikazuje odstotek cepljenih deklic, starih eno leto, podani številsko

* Cepljenost.M - prikazuje odstotek cepljenih fantkov, starih eno leto, podani številsko

Podatki, ki sem jih pridobila za cepljenost, so bili obsežni, saj so vsebovali stolpce, ki jih jaz v svojem projektu nisem potrebovala, zato sem jih odstranila. Tako so mi ostali le podatki o celotni cepljenosti fantkov in deklic. Ostale podatke sem uredila tako, kot pri prejšnji tabeli o umrljivosti. Število vrstic je 57.

Poglejmo si še začetka obeh uvoženih razpredelnic v obliki JSON.

```{r razpredelnice1, echo=FALSE}
kable(head(analiza %>% select(Drzava, Leto, `Odstotek podhranjenih otrok`)))
kable(head(analiza %>% select(Drzava, Leto, `Odstotek nerazvitih otrok`)))
```

Podhranjenost:

* Drzava - podatki za različne države sveta, tip: character

* Leto - podatki so od leta 2010 do 2014, podani so številsko

* Odstotek podhranjenih otrok - prikazuje odstotek podhranjenih otrok, mlajših od 5. leta, podani številsko

Nekaj stolpcev sem odstranila, ter prefiltrirala tako, da so podatki najnovejši (2010-2014) ter da so za oba spola skupaj. Podatke sem uredila na podoben način, kot pri prejšnjih dveh, ki sem jih pridobila v CSV obliki. Število vrstic je 93.

Nerazvitost:

* Drzava - podatki za različne države sveta, tip: character

* Leto - podatki so od leta 2010 do 2014, podani so številsko

* Odstotek nerazvitih otrok - prikazuje odstotek nerazvitosti otrok do 5. leta starosti, podani številsko

Podatke sem uredila podobno kot pri prejšnih tabelah. Število vrstic je 93.

Združila sem tabele o umrljivosti, podhranjenosti, nerazvitosti in cepljenosti in sicer po državah in letih ter jih prefiltrirala, da je smrtnost do 5. leta starosti večja od 50 000 v enem letu. S temi podatki bom sedaj lahko delala v nadaljevanju.

***

# Analiza in vizualizacija podatkov

```{r graf1, echo=FALSE,fig.align='center',fig.cap='Graf število umrlih do 5. leta starosti v državah z največjim številom umrlih'}
ggplot(data=analiza,aes(x=Drzava, y=Smrtnost.do.5.leta.starosti)) + geom_point(colour='red',size=4)
```

Graf prikazuje število umrlih otrok do 5. leta starosti (prave številke so pomnožene s tisoč), v državah, kjer je umrljivost največja. Iz grafa je razvidno, da vodi Nigerija, za njo pa je Demokratična republika Kongo, ostale pa imajo umrljivost manjšo od 200 000 otrok v enem letu.

```{r graf2, echo=FALSE,fig.align='center',fig.cap='Graf število umrlih dojenčkov v državah z največjim številom umrlih'}
ggplot(data=analiza,aes(x=Drzava, y=Smrtnost.dojenckov)) + geom_point(colour='red',size=4)
```

V tem grafu tudi opazimo, da v smrtnosti dojenčkov vodi Nigerija, nato Demokratična republika Kongo, ostale države pa imajo umrljivost manjšo  od 150 000 dojenčkov v enem letu.


```{r graf3, echo=FALSE,fig.align='center',fig.cap='Graf kolikšen delež dojenčkov prispeva k smrtnosti do 5. leta starosti v državah z največjim številom umrlih'}
ggplot(data=analiza,aes(x=Drzava, y=Delez_dojenckov)) + geom_point(colour='red',size=4)+ ylab("Delež umrlih dojenčkov")
```


Graf prikazuje kolikšen delež umrlih dojenčkov prispeva k smrtnosti do 5. leta starosti v državah z največjim številom umrlih. Vidimo, da je največji delež v Bangladešu in sicer 79%, zanimivo pa je, da je v Nigeriji relativno majhen delež umrlih dojenčkov glede na ostale države, čeprav je iz prejšnjih grafov razvidno, da vodi po številu umrlih otrok do 5. leta starosti ter umrlih dojenčkov. To si lahko interpretiramo, da v Nigeriji k smrtnosti do 5. leta dokaj velik delež prinesejo tudi otroci, stari 2-5 let, torej ne umrejo že kot dojenčki.


```{r graf4, echo=FALSE,fig.align='center',fig.cap='Graf odstotek cepljenih otrok (fantkov in deklic) v državah z največjim številom umrlih'}
ggplot(data=pogoste_cepljenostMZ,aes(x=Drzava, y=value))+ geom_bar(aes(fill=variable), stat= "identity", position="dodge") + xlab("Drzave") + ylab("Odstotek cepljenih") + theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust = 1))
```


Največji odstotek cepljenih fantkov v 1. letu starosti je v Jordaniji (93.5%), prav tako deklic (92.7%). Najmanjši odstotek cepljenih fantkov (izmed držav, ki jih analiziram), je v Nigeriji (26.0%), prav tako deklic (25.2%). Sledi Demokratična republika Kongo.

Iz tukaj bi lahko veljalo, da cepljenost res vpliva na umrljivost dojenčkov in otrok do 5. leta starosti, saj je v Nigeriji največja umrljivost in najmanjša cepljenost. Države bom poskusila razdeliti v skupine glede na cepljenost (tiste, ki so si najbolj podobne v odstotku cepljenih) ter nato primerjala z umrljivostjo v teh državah. Predvidevam, da če je večji odstotek cepljenih otrok, da je manjša umrljivost in tako bi lahko modelirala predikcijo s prileganjem (v zadnji fazi).

Sedaj pa si poglejmo še dva zemljevida, ki prikazujeta odstotek podhranjenih otrok po svetu ter odstotek nerazvitih v Afriki:


```{r zemljevid, echo=FALSE,include=FALSE}
source("lib/uvoz.zemljevid.r", encoding = "UTF-8")
```

```{r zemljevid1, echo=FALSE,fig.align='center',fig.cap='Zemljevid sveta - odstotek podhranjenih'}
print(map1)
```

Največji odstotek podhranjenih otrok do 5. leta starosti je v Bangladešu, ta je namreč kar 36.8%. Za njim je Nigerija (31.0%), ostale države pa imajo delež podhranjenih otrok manjši od 30%.

```{r zemljevid2, echo=FALSE,fig.align='center',fig.cap='Zemljevid Afrike - odstotek nerazvitih'}
print(map2)
```

Največji delež (47.8%) nerazvitih otrok je v Malaviju (južna Afrika), sledi Demokratična republika Kongo, zelo blizu pa je tudi Mozambik (prav tako južna Afrika), ostale države pa imajo delež nerazvitih otrok manjši od 40%.


***
